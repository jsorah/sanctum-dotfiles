# Emacs keybindings even if EDITOR is vi(1)
bindkey -e

# History settings
setopt histignorealldups sharehistory
HISTFILE=$HOME/.zsh_history
SAVEHIST=$((1 << 12))
HISTSIZE=$((1 << 10))

# Set a SHLVL-derived value that takes tmux into account. This is used to show
# the current SHLVL in the prompt
if [[ -n $TMUX && -z $TMUX_SHLVL ]] ; then
    TMUX_SHLVL=$((SHLVL - 1))
    export TMUX_SHLVL
fi

# Load POSIX shell startup files and then Bash-specific ones
for sh in "$ENV" "$HOME"/.zshrc.d/*.zsh ; do
    [[ -e $sh ]] && source "$sh"
done
unset -v sh
