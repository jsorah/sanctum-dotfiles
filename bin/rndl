#!/bin/sh
# Print a random line from input
if [ "$#" -eq 0 ] ; then
    td=
    cleanup() {
        [ "$td" ] && rm -fr -- "$td"
        if [ "$1" != EXIT ] ; then
            trap - "$1"
            kill "-$1" "$$"
        fi
    }
    for sig in EXIT HUP INT TERM ; do
        # shellcheck disable=SC2064
        trap "cleanup $sig" "$sig"
    done
    td=$(mktd rndl) || exit
    set -- "$td"/stdin
    cat >"$td"/stdin
fi
lc=$(sed -- '$=;d' "$@") || exit
seed=$(rnds)
ri=$(rndi 1 "$lc" "$seed") || exit
sed -- "$ri"'!d' "$@"
