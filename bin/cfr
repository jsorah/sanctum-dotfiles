#!/bin/sh
# Count all descendants of given directories; don't follow symlinks
for dir in "${@:-.}" ; do
    if ! [ -d "$dir" ] ; then
        printf >&2 'cfr: %s: Not a directory\n' "$dir"
        ex=1
        continue
    fi
    count=$(find "$dir" -exec printf %.sx {} + | wc -c)
    count=$((count - 1))
    printf '%u\t%s\n' "$count" "$dir"
done
exit "${ex:-0}"
